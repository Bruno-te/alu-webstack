#!/usr/bin/env bash
# script to configure subdomains and display information about them.

# Default domain (you can override by passing a different one)
DEFAULT_DOMAIN="top-bruno.tech"
DOMAIN=${1:-$DEFAULT_DOMAIN}
SUB=$2

# Function to get subdomain info
get_subdomain_info() {
    local full_domain=$1
    local sub=$2
    local fqdn="${sub}.${full_domain}"
    local record=$(dig ${fqdn} +short)
    local type=$(dig ${fqdn} | awk '/IN/ && !/;/ {print $4}' | head -n1)
    
    if [[ -n "$record" ]]; then
        echo "The subdomain ${sub} is a ${type} record and points to ${record}"
    else
        echo "The subdomain ${sub} does not resolve or is not set"
    fi
}

# Main logic
if [[ -z "$SUB" ]]; then
    # Default subdomains to check
    for sub in www lb-01 web-01 web-02; do
        get_subdomain_info $DOMAIN $sub
    done
else
    get_subdomain_info $DOMAIN $SUB
fi

